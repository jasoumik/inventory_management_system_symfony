{% extends 'base.html.twig' %}
    {% block stylesheets %}
        {{ parent() }}
        <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-grid.css">
        <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-theme-alpine.css">
    {% endblock %}
{% block title %}StockIn index{% endblock %}

{% block body %}
    {{ include('navbar.html.twig') }}

    <div class="container">
        <h3 class=" text-dark p-2 mt-2">Stock In List</h3>

        <a href="{{ path('stock_in_new') }}" class="btn btn-info float-right" style="margin-right:160px;">Create
            new</a>

        <div class="d-flex justify-content-center mb-2 mt-5 ">
            <div id="myGrid" data-url="{{ path('stock_in_grid') }}" class="ag-theme-alpine" style="height:300px;
        width:750px;">
            </div>
        </div>
    </div>

    <a href="{{ path('product_index') }}" class="btn btn-secondary m-1">Product Home</a>

{% endblock %}

    {% block javascripts %}
        {{ parent() }}
        <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.noStyle.js"></script>
        <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
        <script>

            class BtnCellRenderer {
                init(params) {
                    console.log(params)
                    this.eGui = document.createElement("div");
                    this.eGui.innerHTML = '<button type="button" class="edit btn btn-warning">Edit</button> ' +
                        '<button type="button" class="delete btn btn-danger">Delete</button>';

                    this.eEdit = this.eGui.querySelector('.edit');
                    this.eDelete = this.eGui.querySelector('.delete');

                    this.eventListener = () => location.href = "/stock/in/" + params.data.id + "/edit";
                    this.eEdit.addEventListener("click", this.eventListener);

                    this.deleteEventListener = () => this.sweetAlert;
                    this.eDelete.addEventListener("click", this.deleteEventListener);
                }

                getGui() {
                    return this.eGui;
                }

                sweetAlert() {
                    swal({
                        title: 'Are you sure?',
                        text: "It will permanently deleted !",
                        type: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, delete it!'
                    }).then(function () {
                        swal(
                            'Deleted!',
                            'Your file has been deleted.',
                            'success'
                        );
                    })
                }
            }

            //
            // BtnCellRenderer.prototype.btnClickedHandler = function () {
            //     this.params.clicked(this.params.value);
            //
            // };

            const gridOptions = {
                columnDefs: [
                    {headerName: "Id", field: "id", sortable: true, maxWidth: 80},
                    {headerName: "Name", field: "name", sortable: true},
                    {headerName: "Date", field: "date", sortable: true},
                    {headerName: "Quantity", field: "quantity", sortable: true, maxWidth: 100},
                    {
                        headerName: "Action",
                        field: "id",
                        minWidth: 80,
                        cellRenderer: 'btnCellRenderer',
                    },
                ],
                defaultColDef: {
                    flex: 1,
                },
                rowHeight: 50,
                components: {
                    btnCellRenderer: BtnCellRenderer,
                }
            };

            document.addEventListener('DOMContentLoaded', function () {
                const gridDiv = document.querySelector('#myGrid');
                new agGrid.Grid(gridDiv, gridOptions);
                agGrid.simpleHttpRequest({url: $('#myGrid').data('url')}).then(data => {
                    gridOptions.api.setRowData(data);
                })
            });

        </script>
{#        <script>#}
{#            $(document).ready(function () {#}
{#                $('.delete').on('click', function confirmDelete(e) {#}
{#                    e.preventDefault();#}
{#                    var id = $(this).attr('id');#}
{#                    console.log(id);#}
{#                    //alert(clickedID);#}
{#                    Swal.fire({#}
{#                        title: 'Are you sure?',#}
{#                        icon: 'warning',#}
{#                        showCancelButton: true,#}
{#                        confirmButtonColor: '#d33',#}
{#                        cancelButtonColor: '#3085d6',#}
{#                        confirmButtonText: 'Delete'#}
{#                    }).then((result) => {#}
{#                        if (result.isConfirmed) {#}
{#                            $.post("/product/type/delete/"+id, function (data) {#}
{#                                Swal.fire( {#}
{#                                    title:data.message,#}
{#                                    icon: "success",#}
{#                                    timer:1000,#}
{#                                    button:false,#}
{#                                    position: 'top-end',#}
{#                                    showConfirmButton: false,#}
{#                                }).then(function (){ window.location='/product/type/list'})#}
{#                            })#}
{#                        } else {#}
{#                            Swal.fire({title:"Your file is safe!",#}
{#                                position: 'top-end',#}
{#                                showConfirmButton: false,#}
{#                                icon: "success",#}
{#                                timer:1500,#}
{#                            });#}
{#                        }#}
{#                    });#}
{#                });#}
{#            });#}
{#        </script>#}

    {% endblock %}


